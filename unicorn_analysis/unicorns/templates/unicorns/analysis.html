{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Unicorn Companies Analysis</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light mb-4">
      <div class="container">
        <a class="navbar-brand" href="{% url 'home' %}">Unicorns</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="{% url 'home' %}">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'analysis' %}">Analysis</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container mt-4">
      <h1 class="mb-4">Unicorn Analysis</h1>

      <h2>Summary</h2>
      <ul class="list-group mb-4">
        <li class="list-group-item">
          Total Unicorn Companies: {{ total_unicorns }}
        </li>
        <li class="list-group-item">Average Valuation: ${{ avg_valuation }}</li>
        <li class="list-group-item">
          Average Investors Count: {{ avg_investors_count }}
        </li>
        <li class="list-group-item">
          Total Portfolio Exits: {{ total_portfolio_exits }}
        </li>
      </ul>

      <h2>Distribution by Country</h2>
      <canvas id="countryChart" width="400" height="400" class="mb-4"></canvas>

      <h2>Distribution by Industry</h2>
      <canvas id="industryChart" width="400" height="400" class="mb-4"></canvas>

      <h2>Distribution by Financial Stage</h2>
      <canvas
        id="financialStageChart"
        width="400"
        height="400"
        class="mb-4"
      ></canvas>

      <script>
        const countryCtx = document.getElementById('countryChart').getContext('2d');
        const countryChart = new Chart(countryCtx, {
          type: 'pie',
          data: {
            labels: {{ countries|safe }},
            datasets: [{
              label: 'Unicorns by Country',
              data: {{ country_data|safe }},
              backgroundColor: [
                'rgba(255, 99, 132, 0.6)',
                'rgba(54, 162, 235, 0.6)',
                'rgba(255, 206, 86, 0.6)',
                'rgba(75, 192, 192, 0.6)',
                'rgba(153, 102, 255, 0.6)',
                'rgba(255, 159, 64, 0.6)',
                'rgba(199, 199, 199, 0.6)'
              ],
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
          }
        });

        const industryCtx = document.getElementById('industryChart').getContext('2d');
        const industryChart = new Chart(industryCtx, {
          type: 'pie',
          data: {
            labels: {{ industries|safe }},
            datasets: [{
              label: 'Unicorns by Industry',
              data: {{ industry_data|safe }},
              backgroundColor: [
                'rgba(255, 99, 132, 0.6)',
                'rgba(54, 162, 235, 0.6)',
                'rgba(255, 206, 86, 0.6)',
                'rgba(75, 192, 192, 0.6)',
                'rgba(153, 102, 255, 0.6)',
                'rgba(255, 159, 64, 0.6)',
                'rgba(199, 199, 199, 0.6)'
              ],
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
          }
        });

        const financialStageCtx = document.getElementById('financialStageChart').getContext('2d');
        const financialStageChart = new Chart(financialStageCtx, {
          type: 'pie',
          data: {
            labels: {{ financial_stages|safe }},
            datasets: [{
              label: 'Unicorns by Financial Stage',
              data: {{ financial_stage_data|safe }},
              backgroundColor: [
                'rgba(255, 99, 132, 0.6)',
                'rgba(54, 162, 235, 0.6)',
                'rgba(255, 206, 86, 0.6)',
                'rgba(75, 192, 192, 0.6)',
                'rgba(153, 102, 255, 0.6)',
                'rgba(255, 159, 64, 0.6)',
                'rgba(199, 199, 199, 0.6)'
              ],
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
          }
        });

        // Bar chart for Top Countries by Valuation
        const topCountriesCtx = document.getElementById('topCountriesChart').getContext('2d');
        const topCountriesChart = new Chart(topCountriesCtx, {
          type: 'bar',
          data: {
            labels: {{ top_countries|safe }},
            datasets: [{
              label: 'Valuation (Billion USD)',
              data: {{ top_countries_valuation_data|safe }},
              backgroundColor: 'rgba(54, 162, 235, 0.7)',
              borderColor: 'rgba(54, 162, 235, 1)',
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true,
                title: {
                  display: true,
                  text: 'Valuation (Billion USD)'
                }
              },
              x: {
                title: {
                  display: true,
                  text: 'Country'
                }
              }
            }
          }
        });

        // Bar chart for Top Industries by Valuation
        const topIndustriesCtx = document.getElementById('topIndustriesChart').getContext('2d');
        const topIndustriesChart = new Chart(topIndustriesCtx, {
          type: 'bar',
          data: {
            labels: {{ top_industries|safe }},
            datasets: [{
              label: 'Valuation (Billion USD)',
              data: {{ top_industries_valuation_data|safe }},
              backgroundColor: 'rgba(255, 159, 64, 0.7)',
              borderColor: 'rgba(255, 159, 64, 1)',
              borderWidth: 1
            }]
          },
          options: {
            responsive: true,
            scales: {
              y: {
                beginAtZero: true,
                title: {
                  display: true,
                  text: 'Valuation (Billion USD)'
                }
              },
              x: {
                title: {
                  display: true,
                  text: 'Industry'
                }
              }
            }
          }
        });
      </script>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
